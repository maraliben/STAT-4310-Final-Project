---
title: "Final Project RMD"
author: "Marali Benitez, Youcef Djoudi, Kelly Thackery, Samina Issa, Samira Bechi"
date: "2025-04-09"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, warning=FALSE}
##loading in packages and data
library(wooldridge)
library(AER)
library(quantmod)
library(PerformanceAnalytics)

#ceosal2 data
ceosalary <- ceosal2

#CPS 1988 data
data("CPS1988")
cps <- CPS1988
```

**Data: ceosal2**

**(a) Describe the data. Describe the variables; response, predictors, continuous, categorical variables and missing data**.   



**(b) Build an optimal model. Print summary: discuss F-test, t-tests, Rsquare, S-square. Take out outliers**.  
```{r}
model<- lm(profits ~. -lsalary -lsales, ceosalary)
summary(model)

```
**(c) Briefly discuss residuals**.  



**(d) Make 2 predictions with CI's. Interpret predictions if needed**.  




**Data: CPS 1988**.   

**(a) Describe the data. Describe the variables; response, predictors, continuous, categorical variables and missing data**.       

```{r}
head(cps)
```

*The CPS 1988 data set describes the wages of men 18 to 70 (in dollars per week), number of years of education, number of years of potential work experience, ethnicity (a factor with levels "cauc" for caucasian or "afam" for african american), smsa (which is a factor that records if the individual resides in a Standard Metropolitan Statistical area, with 1 being yes and 0 being no), region (a factor with levels "northeast", "midwest", "south", and "west), and parttime (a factor that answers the question if the individual works parttime, with 1 being yes and 0 being no). We used wage as the response variable and the rest of the variables as predictor values. There are no missing or NA values in the dataset. *    



**(b) Build an optimal model. Print summary: discuss F-test, t-tests, Rsquare, S-square. Take out outliers**.      

```{r}
#preliminary model
cpsmodel <- lm(wage~., data = cps)
summary(model)
```

*The preliminary model summary shows that the linear model has an r^2 value of .8776, meaning that 87.76% of the variation in the data can be explained by the model. *

**(c) Briefly discuss residuals**.  



**(d) Make 2 predictions with CI's. Interpret predictions if needed**.  

## Finance Application  

**Read stock prices for 5 different stocks. Close prices for 3 years, most recent 2024. Criteria Beta > 1, PE > 10, growth > 10%, different industries.**
```{r}
# Read stock prices
start<- as.Date("2021-01-01")
end<-as.Date("2024-01-01")
DIS <- getSymbols("DIS", from=start, to=end, auto.assign=FALSE)
NVDA <- getSymbols("NVDA", from=start, to=end, auto.assign=FALSE)
CVNA<-getSymbols("CVNA", from=start, to=end, auto.assign=FALSE)
SPOT<-getSymbols("SPOT", from=start, to=end, auto.assign=FALSE)
DASH<-getSymbols("DASH", from=start, to=end, auto.assign=FALSE)


## Closed price
DIS.close <- DIS[ ,3]
NVDA.close <- NVDA[ ,3]
CVNA.close <- CVNA[ ,3]
SPOT.close <- SPOT[ ,3]
DASH.close <- SPOT[ ,3]

## Returns
DIS.return <- dailyReturn(DIS.close)
NVDA.return <- dailyReturn(NVDA.close)
CVNA.return <- dailyReturn(CVNA.close)
SPOT.return <- dailyReturn(SPOT.close)
DASH.return <- dailyReturn(DASH.close)


```

**Disney: beta(1.44), P/E(29.69), Growth Estimate(29.1), Industry: Entertainment    
  Nvidia: beta(1.96), P/E(38.89), Growth Estimate(13.7%), Industry: Semiconductors    
  Carvana: beta(3.62), P/E(138.64), Growth Estimate(65.9%), Industry: Auto & Truck Dealerships     Spotify: beta(1.75), P/E(90.03), Growth Estimate(23.1%), Industry: Internet Content & Information  
  DoorDash: beta(1.69), P/E(627.07), Growth Estimate(36.8%), Industry: Communication Services**      
        
**(a)Plot close prices on three different plots. Notice the general "t????" "variation" on different spans.**  
```{r, warning=FALSE}
#Plot close stock prices on different plots.
plot(DIS.close, main = "Disney Closing Prices", type = "l", col = "blue", xlab = "Date", ylab = "Price")
plot(NVDA.close, main = "NVIDIA Closing Prices", type = "l", col = "red", xlab = "Date", ylab = "Price")
plot(CVNA.close, main = "Carvana Closing Prices", type = "l", col = "green", xlab = "Date", ylab = "Price")
plot(SPOT.close, main = "Spotify Closing Prices", type = "l", col = "magenta", xlab = "Date", ylab = "Price")
plot(DASH.close, main = "DoorDash Closing Prices", type = "l", col = "purple", xlab = "Date", ylab = "Price")
```

**Remark: There is significant drop for Disney early in 2022 and then remains volatile. NVidia has seen a steady rise witha few minor dips in last half of 2024. We see Carvana fall spring 2022 and doesn't start to rise again until spring 2024. **  

**(b)Calculate annualized average return and annualized risk. Present the correlations matrix.**  
```{r, warning=FALSE}
library(PerformanceAnalytics)
#Calculate the annualized return and annualized risk of each stock.
## A function to compute the Annualized Expected return/Risk
mu.sigma <- function(return){
  mu.ann <- mean(return) * 252
  sigma.ann <- sd(return) * sqrt(252)
  return(c(mu.ann, sigma.ann))
}

## Annualized Expected Return and Annualized Risk
dis <- mu.sigma(DIS.return)
nvda <- mu.sigma(NVDA.return)
cvna <- mu.sigma(CVNA.return)
spot <- mu.sigma(SPOT.return)
dash <- mu.sigma(DASH.return)


cat('Disney:', dis, '\n')
cat('NVIDIA:', nvda, '\n')
cat('Carvana:', cvna, '\n')
cat('Spoify:', spot, '\n')
cat('DoorDash:', dash, '\n')


## Correlation Matrix
returns <- cbind(DIS.return,NVDA.return,CVNA.return,SPOT.return,DASH.return)
colnames(returns) <- c('Disney', 'NVIDIA', 'Carvana', 'Spotify','DoorDash')
head(returns)
chart.Correlation(returns)
```


**Remark: **  

**(c)Plot cumulative returns on one common plot.**  
```{r, warning=FALSE}
## Compute cumulative returns
cumulative_returns <- cumprod(1 + returns)

## Using chart.CumReturns from PerformanceAnalytics
chart.CumReturns(returns, wealth.index = TRUE, legend.loc = 'topleft',
                 main = 'Cumulative Returns', colorset = c('blue', 'red','green','magenta','purple'))

```

**Remark: **  

**(d)Estimate alpha, beta, Rsquare.**  
```{r}
## SP500(Benchmark)
SP500<- getSymbols("^GSPC", from=start, to=end, auto.assign = FALSE)
SP500.close <- SP500[ , 5]
SP500.return<- dailyReturn(SP500.close)

##Riskfree rates 
rf <- read.csv(file.choose(), head=T, skip=3) # a data frame
head(rf)
rf$dates <- as.Date(rf$X, format="%Y%m%d") # create dates as X in the fama.french
## sort ff according to dates 
rf.new <- rf[rf$dates >= "2021-01-01" & rf$dates<= "2024-01-01", ] 
head(rf.new)
#dim(rf.new)
#tail(rf.new)
rf.new <- rf.new[ -754, ]
#dim(rf.new)

# Estimate alpha, beta, Rsquare of 3 stocks.
beta <- function(stock.return, market.return, riskfree.rate) {
    stock.excess <- stock.return - riskfree.rate
    market.excess <- market.return - riskfree.rate
    model <- lm(stock.excess ~ market.excess)
    coefs <- coef(model)
    Rsquare <- summary(model)$r.squared
    results <- data.frame(alpha = coefs[1], beta = coefs[2], Rsquare = Rsquare)
    return(results)
}

# Call beta function for each stock
res_DIS   <- beta(DIS.return, SP500.return, rf.new$RF)
res_NVDA  <- beta(NVDA.return, SP500.return, rf.new$RF)
res_CVNA  <- beta(CVNA.return, SP500.return, rf.new$RF)
res_SPOT  <- beta(SPOT.return, SP500.return, rf.new$RF)
res_DASH  <- beta(DASH.return, SP500.return, rf.new$RF)

# Combine the individual results into one table
results_table <- rbind(Disney  = res_DIS, NVIDIA  = res_NVDA, Carvana = res_CVNA, 
                       SPOT = res_SPOT, DASH = res_DASH)

# Display the resulting table
print(results_table)

```

**Remark: **  





